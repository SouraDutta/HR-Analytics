model_1<-glm(Attrition~.-1,data=train,family ="binomial")
summary(model_1)
#checking for multi colinearity in the variables
model_2<-stepAIC(model_1,direction="both")
summary(model_2)
vif(model_2)
model_3<-glm(Attrition ~ Age + DistanceFromHome + MonthlyIncome + NumCompaniesWorked +
StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales + Education.x5 + EducationField.xMarketing +
EducationField.xOther + EducationField.xTechnical.Degree +
JobLevel.x2 + JobRole.xLaboratory.Technician + JobRole.xResearch.Director +
JobRole.xResearch.Scientist + JobRole.xSales.Executive +
MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 + JobSatisfaction.x2 + JobSatisfaction.x3 +
JobSatisfaction.x4 + WorkLifeBalance.x2 + WorkLifeBalance.x3 +
WorkLifeBalance.x4 + JobInvolvement.x3 + Jan + Feb + Jul +
Sep + Oct ,data=train,family = "binomial")
summary(model_3)
vif(model_3)
#Removal of stockoptionlevel
model_4<-glm(Attrition ~ Age + DistanceFromHome + MonthlyIncome + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales + Education.x5 + EducationField.xMarketing +
EducationField.xOther + EducationField.xTechnical.Degree +
JobLevel.x2 + JobRole.xLaboratory.Technician + JobRole.xResearch.Director +
JobRole.xResearch.Scientist + JobRole.xSales.Executive +
MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 + JobSatisfaction.x2 + JobSatisfaction.x3 +
JobSatisfaction.x4 + WorkLifeBalance.x2 + WorkLifeBalance.x3 +
WorkLifeBalance.x4 + JobInvolvement.x3 + Jan + Feb + Jul +
Sep + Oct ,data=train,family = "binomial")
summary(model_4)
vif(model_4)
#Removal of Educatio.x5
model_5<-glm(Attrition ~ Age + DistanceFromHome + MonthlyIncome + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales + EducationField.xMarketing +
EducationField.xOther + EducationField.xTechnical.Degree +
JobLevel.x2 + JobRole.xLaboratory.Technician + JobRole.xResearch.Director +
JobRole.xResearch.Scientist + JobRole.xSales.Executive +
MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 + JobSatisfaction.x2 + JobSatisfaction.x3 +
JobSatisfaction.x4 + WorkLifeBalance.x2 + WorkLifeBalance.x3 +
WorkLifeBalance.x4 + JobInvolvement.x3 + Jan + Feb + Jul +
Sep + Oct ,data=train,family = "binomial")
summary(model_5)
vif(model_5)
#Removal of EducationField.xMarketing
model_6<-glm(Attrition ~ Age + DistanceFromHome + MonthlyIncome + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales +EducationField.xOther + EducationField.xTechnical.Degree +
JobLevel.x2 + JobRole.xLaboratory.Technician + JobRole.xResearch.Director +
JobRole.xResearch.Scientist + JobRole.xSales.Executive +
MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 + JobSatisfaction.x2 + JobSatisfaction.x3 +
JobSatisfaction.x4 + WorkLifeBalance.x2 + WorkLifeBalance.x3 +
WorkLifeBalance.x4 + JobInvolvement.x3 + Jan + Feb + Jul +
Sep + Oct ,data=train,family = "binomial")
summary(model_6)
vif(model_6)
#Removal of EducationField.xOther
model_7<-glm(Attrition ~ Age + DistanceFromHome + MonthlyIncome + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales+ EducationField.xTechnical.Degree +
JobLevel.x2 + JobRole.xLaboratory.Technician + JobRole.xResearch.Director +
JobRole.xResearch.Scientist + JobRole.xSales.Executive +
MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 + JobSatisfaction.x2 + JobSatisfaction.x3 +
JobSatisfaction.x4 + WorkLifeBalance.x2 + WorkLifeBalance.x3 +
WorkLifeBalance.x4 + JobInvolvement.x3 + Jan + Feb + Jul +
Sep + Oct ,data=train,family = "binomial")
summary(model_7)
vif(model_7)
#Removal of EducationField.xTechnical.Degree
model_8<-glm(Attrition ~ Age + DistanceFromHome + MonthlyIncome + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales+JobLevel.x2 + JobRole.xLaboratory.Technician + JobRole.xResearch.Director +
JobRole.xResearch.Scientist + JobRole.xSales.Executive +
MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 + JobSatisfaction.x2 + JobSatisfaction.x3 +
JobSatisfaction.x4 + WorkLifeBalance.x2 + WorkLifeBalance.x3 +
WorkLifeBalance.x4 + JobInvolvement.x3 + Jan + Feb + Jul +
Sep + Oct ,data=train,family = "binomial")
summary(model_8)
vif(model_8)
#Removal of Jan
model_9<-glm(Attrition ~ Age + DistanceFromHome + MonthlyIncome + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales+JobLevel.x2 + JobRole.xLaboratory.Technician + JobRole.xResearch.Director +
JobRole.xResearch.Scientist + JobRole.xSales.Executive +
MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 + JobSatisfaction.x2 + JobSatisfaction.x3 +
JobSatisfaction.x4 + WorkLifeBalance.x2 + WorkLifeBalance.x3 +
WorkLifeBalance.x4 + JobInvolvement.x3 + Feb + Jul +
Sep + Oct ,data=train,family = "binomial")
summary(model_9)
vif(model_9)
#Removal of DistanceFromHome
model_10<-glm(Attrition ~ Age+ MonthlyIncome + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales+JobLevel.x2 + JobRole.xLaboratory.Technician + JobRole.xResearch.Director +
JobRole.xResearch.Scientist + JobRole.xSales.Executive +
MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 + JobSatisfaction.x2 + JobSatisfaction.x3 +
JobSatisfaction.x4 + WorkLifeBalance.x2 + WorkLifeBalance.x3 +
WorkLifeBalance.x4 + JobInvolvement.x3 + Feb + Jul +
Sep + Oct ,data=train,family = "binomial")
summary(model_10)
vif(model_10)
#Removal of Feb
model_11<-glm(Attrition ~ Age+ MonthlyIncome + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales+JobLevel.x2 + JobRole.xLaboratory.Technician + JobRole.xResearch.Director +
JobRole.xResearch.Scientist + JobRole.xSales.Executive +
MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 + JobSatisfaction.x2 + JobSatisfaction.x3 +
JobSatisfaction.x4 + WorkLifeBalance.x2 + WorkLifeBalance.x3 +
WorkLifeBalance.x4 + JobInvolvement.x3+ Jul +
Sep + Oct ,data=train,family = "binomial")
summary(model_11)
vif(model_11)
#Removal of MonthlyIncome
model_12<-glm(Attrition ~ Age + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales+JobLevel.x2 + JobRole.xLaboratory.Technician + JobRole.xResearch.Director +
JobRole.xResearch.Scientist + JobRole.xSales.Executive +
MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 + JobSatisfaction.x2 + JobSatisfaction.x3 +
JobSatisfaction.x4 + WorkLifeBalance.x2 + WorkLifeBalance.x3 +
WorkLifeBalance.x4 + JobInvolvement.x3+ Jul +
Sep + Oct ,data=train,family = "binomial")
summary(model_12)
vif(model_12)
#Removal of JobLevel.x2
model_13<-glm(Attrition ~ Age + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales + JobRole.xLaboratory.Technician + JobRole.xResearch.Director +
JobRole.xResearch.Scientist + JobRole.xSales.Executive +
MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 + JobSatisfaction.x2 + JobSatisfaction.x3 +
JobSatisfaction.x4 + WorkLifeBalance.x2 + WorkLifeBalance.x3 +
WorkLifeBalance.x4 + JobInvolvement.x3+ Jul +
Sep + Oct ,data=train,family = "binomial")
summary(model_13)
vif(model_13)
#Removal of JobRole.xLaboratory.Technician
model_14<-glm(Attrition ~ Age + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales + JobRole.xResearch.Director +
JobRole.xResearch.Scientist + JobRole.xSales.Executive +
MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 + JobSatisfaction.x2 + JobSatisfaction.x3 +
JobSatisfaction.x4 + WorkLifeBalance.x2 + WorkLifeBalance.x3 +
WorkLifeBalance.x4 + JobInvolvement.x3+ Jul +
Sep + Oct ,data=train,family = "binomial")
summary(model_14)
vif(model_14)
#Removal of JobRole.xResearch.Scientist
model_15<-glm(Attrition ~ Age + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales + JobRole.xResearch.Director +
JobRole.xSales.Executive +
MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 + JobSatisfaction.x2 + JobSatisfaction.x3 +
JobSatisfaction.x4 + WorkLifeBalance.x2 + WorkLifeBalance.x3 +
WorkLifeBalance.x4 + JobInvolvement.x3+ Jul +
Sep + Oct ,data=train,family = "binomial")
summary(model_15)
vif(model_15)
#Removal of JobInvolvement.x3
model_16<-glm(Attrition ~ Age + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales + JobRole.xResearch.Director +
JobRole.xSales.Executive +
MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 + JobSatisfaction.x2 + JobSatisfaction.x3 +
JobSatisfaction.x4 + WorkLifeBalance.x2 + WorkLifeBalance.x3 +
WorkLifeBalance.x4 + Jul +Sep + Oct ,data=train,family = "binomial")
summary(model_16)
vif(model_16)
#Removal of JobRole.xResearch.Director
model_17<-glm(Attrition ~ Age + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales  +
JobRole.xSales.Executive +
MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 + JobSatisfaction.x2 + JobSatisfaction.x3 +
JobSatisfaction.x4 + WorkLifeBalance.x2 + WorkLifeBalance.x3 +
WorkLifeBalance.x4 + Jul +Sep + Oct ,data=train,family = "binomial")
summary(model_17)
vif(model_17)
#Removal of JobRole.xSales.Executive
model_18<-glm(Attrition ~ Age + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales+MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 + JobSatisfaction.x2 + JobSatisfaction.x3 +
JobSatisfaction.x4 + WorkLifeBalance.x2 + WorkLifeBalance.x3 +
WorkLifeBalance.x4 + Jul +Sep + Oct ,data=train,family = "binomial")
summary(model_18)
vif(model_18)
#Removal of JobSatisfaction.x3
model_19<-glm(Attrition ~ Age + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales+MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 + JobSatisfaction.x2 +
JobSatisfaction.x4 + WorkLifeBalance.x2 + WorkLifeBalance.x3 +
WorkLifeBalance.x4 + Jul +Sep + Oct ,data=train,family = "binomial")
summary(model_19)
vif(model_19)
#Removal of JobSatisfaction.x2
model_20<-glm(Attrition ~ Age + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales+MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 +JobSatisfaction.x4 + WorkLifeBalance.x2 + WorkLifeBalance.x3 +
WorkLifeBalance.x4 + Jul +Sep + Oct ,data=train,family = "binomial")
summary(model_20)
vif(model_20)
#Removal of WorkLifeBalance.x4
model_21<-glm(Attrition ~ Age + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales+MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 +JobSatisfaction.x4 + WorkLifeBalance.x2 + WorkLifeBalance.x3 +
Jul +Sep + Oct ,data=train,family = "binomial")
summary(model_21)
vif(model_21)
#Removal of WorkLifeBalance.x2
model_22<-glm(Attrition ~ Age + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales+MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 +JobSatisfaction.x4 +WorkLifeBalance.x3 +
Jul +Sep + Oct ,data=train,family = "binomial")
summary(model_22)
vif(model_22)
#Removal of  Jul
model_23<-glm(Attrition ~ Age + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales+MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 +JobSatisfaction.x4 +WorkLifeBalance.x3 +
Sep + Oct ,data=train,family = "binomial")
summary(model_23)
vif(model_23)
#Removal of   Sep
model_24<-glm(Attrition ~ Age + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager + BusinessTravel.xTravel_Frequently +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales+MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 +JobSatisfaction.x4 +WorkLifeBalance.x3 +
Oct ,data=train,family = "binomial")
summary(model_24)
vif(model_24)
#Removal of  BusinessTravel.xTravel_Frequently
model_25<-glm(Attrition ~ Age + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager +
BusinessTravel.xTravel_Rarely + Department.xResearch...Development +
Department.xSales+MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 +JobSatisfaction.x4 +WorkLifeBalance.x3 +
Oct ,data=train,family = "binomial")
summary(model_25)
vif(model_25)
#Removal of  BusinessTravel.xTravel_Rarely
model_26<-glm(Attrition ~ Age + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager +
Department.xResearch...Development +
Department.xSales+MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 +JobSatisfaction.x4 +WorkLifeBalance.x3 +
Oct ,data=train,family = "binomial")
summary(model_26)
vif(model_26)
#Removal of WorkLifeBalance.x3
model_27<-glm(Attrition ~ Age + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager +
Department.xResearch...Development +
Department.xSales+MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 +JobSatisfaction.x4 +
Oct ,data=train,family = "binomial")
summary(model_27)
vif(model_27)
#Removal of Department.xResearch...Development
model_28<-glm(Attrition ~ Age + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager +
Department.xSales+MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 +JobSatisfaction.x4 +
Oct ,data=train,family = "binomial")
summary(model_28)
vif(model_28)
#Removal of   Department.xSales
model_29<-glm(Attrition ~ Age + NumCompaniesWorked +
TotalWorkingYears + TrainingTimesLastYear +
YearsSinceLastPromotion + YearsWithCurrManager +
MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 +JobSatisfaction.x4 +
Oct ,data=train,family = "binomial")
summary(model_29)
vif(model_29)
#Removal of   TotalWorkingYears
model_30<-glm(Attrition ~ Age + NumCompaniesWorked +
TrainingTimesLastYear+YearsSinceLastPromotion + YearsWithCurrManager +
MaritalStatus.xSingle + EnvironmentSatisfaction.x2 + EnvironmentSatisfaction.x3 +
EnvironmentSatisfaction.x4 +JobSatisfaction.x4 +
Oct ,data=train,family = "binomial")
summary(model_30)
vif(model_30)
#Evaluation of model
Predict_2 <- predict(model_30,type="response",test[,-1])
summary(Predict_2)
test$prob<-Predict_2
View(test)
test_pred_attrition<-factor(ifelse(Predict_2>0.158,"yes","no"))
test_actual_attrition<-factor(ifelse(test$Attrition==1,"yes","no"))
table_1<-table(test_actual_attrition,test_pred_attrition)
#calculation of confusion matrix
test_conf<-confusionMatrix(test_pred_attrition,test_actual_attrition,positive = "yes")
conf_values<-test_conf
conf_values
test_pred_attrition
test_actual_attrition
View(test)
summary(Predict_2)
Predict_2
1323*3
4110/.3
4110*.3
4110*.25
4110*.35
3087/4110
3087+1323
4410*3
4410*.3
View(train)
quantile_for_decile <- quantile(test$prob, probs = seq(0.1,0.9,by=0.1))
test$decile <- findInterval(test$prob,c(-Inf,quantile_for_decile, Inf))
View(test)
decile_group<-group_by(test,decile)
summarise(decile_group,n())
View(decile_group)
summarise(decile_group,obv=n(),min_prob=min(p=prob), max_prob=max(prob), default_cnt=sum(Attrition),
non_default_cnt=obv -default_cnt,
default_rate=(default_cnt/obv)*100)
summarise(decile_group,obv=n(),min_prob=min(p=prob), max_prob=max(prob), Att_cnt=sum(Attrition),
non_default_cnt=obv -Att_cnt,
Att_rate=(Att_cnt/obv)*100)
summarise(decile_group,obv=n(),min_prob=min(p=prob), max_prob=max(prob), Att_cnt=sum(Attrition),
non_Att_cnt=obv -Att_cnt,
Att_rate=(Att_cnt/obv)*100)
library(ROCR)
#on testing  data
pred_test<- prediction(test_pred_attrition, test_actual_attrition)
test_pred_attrition
test_pred_attr<-ifelse(test_pred_attrition=="Yes",1,0)
test_actual_attr<-ifelse(test_actual_attrition=="Yes",1,0)
pred_test<- prediction(test_pred_attr, test_actual_attr)
test_pred_attr
sum(test_pred_attr)
View(test_pred_attrition)
test_pred_attr<-ifelse(test_pred_attrition=="yes",1,0)
test_actual_attr<-ifelse(test_actual_attrition=="yes",1,0)
pred_test<- prediction(test_pred_attr, test_actual_attr)
performance_test<- performance(pred_test, "tpr", "fpr")
ks_table_test <- attr(performance_test, "y.values")[[1]] -
(attr(performance_test, "x.values")[[1]])
max(ks_table_test)
lift <- function(labels , predicted_prob,groups=10) {
if(is.factor(labels)) labels  <- as.integer(as.character(labels ))
if(is.factor(predicted_prob)) predicted_prob <- as.integer(as.character(predicted_prob))
helper = data.frame(cbind(labels , predicted_prob))
helper[,"bucket"] = ntile(-helper[,"predicted_prob"], groups)
gaintable = helper %>% group_by(bucket)  %>%
summarise_at(vars(labels ), funs(total = n(),
totalresp=sum(., na.rm = TRUE))) %>%
mutate(Cumresp = cumsum(totalresp),
Gain=Cumresp/sum(totalresp)*100,
Cumlift=Gain/(bucket*(100/groups)))
return(gaintable)
}
Churn_decile = lift(test_actual_attr, Predict_2, groups = 10)
View(Churn_decile)
quantile_for_decile <- quantile(test$prob, probs = seq(0.1,0.9,by=0.1))
test$decile <- findInterval(test$prob,c(-Inf,quantile_for_decile, Inf))
decile_group<-group_by(test,decile)
summarise(decile_group,obv=n(),min_prob=min(p=prob), max_prob=max(prob), Att_cnt=sum(Attrition),
non_default_cnt=obv -Att_cnt,
Att_rate=(Att_cnt/obv)*100)
ggplot(Churn_decile,aes(Churn_decile$bucket,Churn_decile$Gain))+geom_point()+geom_smooth()
ggplot(Churn_decile,aes(Churn_decile$bucket,Churn_decile$Gain))+geom_point()+geom_smooth()+geom_line(aes(x=y))
ggplot(Churn_decile,aes(Churn_decile$bucket,Churn_decile$Gain))+geom_point()+geom_smooth()+geom_abline(slope = 45)
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Gain))+geom_point()+geom_smooth()+geom_abline(slope = 45)
source('~/GitHub/HR-Analytics/HR_practice.R', echo=TRUE)
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Gain))+geom_point()+geom_smooth()#+geom_abline(slope = 45)
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Gain))+geom_point()+geom_smooth()+geom_label()
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Gain))+geom_point()+geom_smooth()+geom_text(aes(label=Churn_decile$Gain),hjust=0, vjust=0)
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Gain))+geom_point()+geom_line()+geom_text(aes(label=Churn_decile$Gain),hjust=0, vjust=0)
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Gain))+geom_point()+geom_line(aes(y=Churn_decile$Gain))+geom_text(aes(label=Churn_decile$Gain),hjust=0, vjust=0)
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket)))+geom_point()+geom_line(aes(y=Churn_decile$Gain))+geom_text(aes(label=Churn_decile$Gain),hjust=0, vjust=0)
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket)))+geom_line(aes(y=Churn_decile$Gain))+geom_text(aes(label=Churn_decile$Gain),hjust=0, vjust=0)
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket)))+geom_line(aes(y=Churn_decile$Gain))#+geom_text(aes(label=Churn_decile$Gain),hjust=0, vjust=0)
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Gain))+geom_point()+geom_smooth()+geom_text(aes(label=Churn_decile$Gain),hjust=0, vjust=0)
ggplot(Churn_decile,aes(as.factor(bucket),Cumlift))+geom_point()+geom_smooth()+geom_hline(yintercept = 1)
ggplot(Churn_decile,aes(as.factor(bucket),Cumlift))+geom_point()+geom_smooth()+geom_hline(yintercept = 1)+geom_text(aes(label=Churn_decile$Gain),hjust=0, vjust=0)
ggplot(Churn_decile,aes(as.factor(bucket),Cumlift))+geom_point()+geom_smooth()+geom_hline(yintercept = 1)+geom_text(aes(label=Churn_decile$Cumlift),hjust=0, vjust=0)
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Gain))+geom_line()+geom_point()+geom_smooth()+geom_text(aes(label=Churn_decile$Gain),hjust=0, vjust=0)
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Gain,group=1))+geom_line()+geom_point()+geom_smooth()+geom_text(aes(label=Churn_decile$Gain),hjust=0, vjust=0)
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Gain,group=1))+geom_line()+geom_point()+geom_text(aes(label=Churn_decile$Gain),hjust=0, vjust=0)
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Gain,group=1))+
geom_line()+geom_point()+geom_text(aes(label=Churn_decile$Gain),hjust=1, vjust=0)
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Gain,group=1))+
geom_line()+geom_point()+geom_text(aes(label=Churn_decile$Gain),hjust=0, vjust=1)
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Gain,group=1,
label=sprintf("%0.2f", round(Gain, digits = 2))))+ geom_line()+geom_point()
+geom_text(aes(,hjust=0, vjust=1))
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Gain,group=1,
label=sprintf("%0.2f", round(Gain, digits = 2))))+ geom_line()+geom_point()+
geom_text(aes(,hjust=0, vjust=1))
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Gain,group=1,
label=sprintf("%0.2f", round(Churn_decile$Cumlift, digits = 2))))+ geom_line()+geom_point()+
geom_text(aes(hjust=0, vjust=1))+geom_hline(yintercept = 1)
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Cumlift,group=1,
label=sprintf("%0.2f", round(Churn_decile$Cumlift, digits = 2))))+ geom_line()+geom_point()+
geom_text(aes(hjust=0, vjust=1))+geom_hline(yintercept = 1)
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Cumlift,group=1,
label=sprintf("%0.2f", round(Churn_decile$Cumlift, digits = 2))))+ geom_line()+geom_point()+
geom_text(aes(hjust=0, vjust=1))+geom_hline(yintercept = 1)+xlab("") +
ylab("")
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Cumlift,group=1,
label=sprintf("%0.2f", round(Churn_decile$Cumlift, digits = 2))))+ geom_line()+geom_point()+
geom_text(aes(hjust=0, vjust=1))+geom_hline(yintercept = 1)+xlab("Bucket") +
ylab("Cumlift")
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Cumlift,group=1,
label=sprintf("%0.2f", round(Churn_decile$Cumlift, digits = 2))))+ geom_line()+geom_point()+
geom_text(aes(hjust=0, vjust=1))+geom_hline(yintercept = 1)+xlab("Bucket") +
ylab("Cumlift")+title("Lift Chart")
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Cumlift,group=1,
label=sprintf("%0.2f", round(Churn_decile$Cumlift, digits = 2))))+ geom_line()+geom_point()+
geom_text(aes(hjust=0, vjust=1))+geom_hline(yintercept = 1)+xlab("Bucket") +
ylab("Cumlift")+theme(title = "Lift Chart")
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Cumlift,group=1,
label=sprintf("%0.2f", round(Churn_decile$Cumlift, digits = 2))))+ geom_line()+geom_point()+
geom_text(aes(hjust=0, vjust=1))+geom_hline(yintercept = 1)+xlab("Bucket") +
ylab("Cumlift")+theme(title =element_text( "Lift Chart"))
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Cumlift,group=1,
label=sprintf("%0.2f", round(Churn_decile$Cumlift, digits = 2))))+ geom_line()+geom_point()+
geom_text(aes(hjust=0, vjust=1))+geom_hline(yintercept = 1)+xlab("Bucket") +
ylab("Cumlift")+labs(title="Lift Chart")#+theme(title =element_text( "Lift Chart"))
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Cumlift,group=1,
label=sprintf("%0.2f", round(Churn_decile$Cumlift, digits = 2))))+ geom_line()+geom_point()+
geom_text(aes(hjust=0, vjust=1))+geom_hline(yintercept = 1)+xlab("Bucket") +
ylab("Cumlift")+labs(title="Lift Chart")
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Cumlift,group=1,
label=sprintf("%0.2f", round(Churn_decile$Cumlift, digits = 2))))+ geom_line()+geom_point()+
geom_text(aes(hjust=0, vjust=0))+geom_hline(yintercept = 1)+xlab("Bucket") +
ylab("Cumlift")+labs(title="Lift Chart")
ggplot(Churn_decile,aes(as.factor(Churn_decile$bucket),Churn_decile$Cumlift,group=1,
label=sprintf("%0.2f", round(Churn_decile$Cumlift, digits = 2))))+ geom_line()+geom_point()+
geom_text(aes(hjust=0, vjust=-.2))+geom_hline(yintercept = 1)+xlab("Bucket") +
ylab("Cumlift")+labs(title="Lift Chart")
View(Churn_decile)
ave_working_hour<-cbind(customer_id,ave_working_hour)
####data merge and cleanup####
all_updated<-merge(x=all,y=ave_working_hour,by.x = "EmployeeID",by.y = "customer_id")
View(all_updated)
str(all_updated)
#data cleanup for new variables
boxplot(all_updated$Jan)
sum(is.na(all_updated$Jan))
stat6<-quantile(all_updated$Jan, 0.95, na.rm = TRUE)
all_updated$Jan[all_updated$Jan>stat6]<-stat6
